


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utils &mdash; Catalyst 22.02.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Runners" href="runners.html" /> 

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167094275-1"></script>
  <script src="../_static/js/googleanalytics.min.js"></script>
  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>

      <div class="main-menu">
        <ul>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButtonEcosystem" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://alchemy.host">
                  <span class=dropdown-title>Alchemy</span>
                  <p>Experiments logging & visualization</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">
                  <span class=dropdown-title>Catalyst</span>
                  <p>Accelerated deep learning R&D</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">
                  <span class=dropdown-title>Reaction</span>
                  <p>Convenient deep learning models serving</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div class="projects-dropdown">
              <a id="dropdownMenuButtonProjects" data-toggle="projects-dropdown">
                Projects
              </a>
              <div class="projects-dropdown-menu">
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">
                  <span class=dropdown-title>Codestyle</span>
                  <p>Joint R&D codestyle</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">
                  <span class=dropdown-title>Catalyst.Neuro</span>
                  <p>Catalyst.Team and TReNDS collaborative project</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">
                  <span class=dropdown-title>Classification</span>
                  <p>Image classification pipeline with transfer learning</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">
                  <span class=dropdown-title>Detection</span>
                  <p>Object detection pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">
                  <span class=dropdown-title>Segmentation</span>
                  <p>Image semantic segmentation pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">
                  <span class=dropdown-title>Catalyst.GAN</span>
                  <p>GAN pipelines</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/dl-course">Deep learning course</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="catalyst-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="catalyst-left-menu" id="catalyst-left-menu">
      <div class="catalyst-side-scroll">
        <div class="catalyst-menu catalyst-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="catalyst-left-menu-search">
            

            
              
              
                <div class="version">
                  <a href="https://catalyst-team.github.io/catalyst/versions.html">22.02</a>
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Catalyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart 101</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#minimal-examples">Minimal examples</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-a-pytorch-framework-for-accelerated-deep-learning-r-d-ad9621e4ca88?source=friends_link&amp;sk=885b4409aecab505db0a63b06f19dcef">Catalyst — Accelerated Deep Learning R&amp;D</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ddp.html">Distributed training tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/callback.html">Callback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/engine.html">Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/metric.html">Metric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/runner.html">Runner</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/intro.html">How to make X?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/checkpointing.html">Checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dataflow.html">Dataflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dp.html">Dataparallel training (cpu, single/multi-gpu)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/debugging.html">Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/ddp.html">Distributed training (multi-gpu, multi-node)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/early_stopping.html">Early stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/mixed_precision.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/multi_components.html">Multiple components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/multi_keys.html">Multiple input and output keys</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/optuna.html">Optuna integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/settings.html">Settings</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="engines.html">Engines</a></li>
<li class="toctree-l1"><a class="reference internal" href="loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="runners.html">Runners</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md">How to start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#acknowledgments">Acknowledgments</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="catalyst-container">
      <div class="catalyst-page-level-bar" id="catalyst-page-level-bar">
        <div class="catalyst-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="catalyst-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Utils</li>
    
    
      <li class="catalyst-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/catalyst-team/catalyst/blob/master/docs/api/utils.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="catalyst-shortcuts-wrapper" id="catalyst-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="catalyst-content-wrap" class="catalyst-content-wrap">
        <div class="catalyst-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="catalyst-article" class="catalyst-article">
              
  <section id="utils">
<h1>Utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-catalyst.utils.config" id="id1">Config</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.distributed" id="id2">Distributed</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.misc" id="id3">Misc</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.onnx" id="id4">Onnx</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.pruning" id="id5">Pruning</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.quantization" id="id6">Quantization</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.torch" id="id7">Torch</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.tracing" id="id8">Tracing</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.image" id="id9">Image (contrib)</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.report" id="id10">Report (contrib)</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.thresholds" id="id11">Thresholds (contrib)</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.visualization" id="id12">Visualization (contrib)</a></p></li>
</ul>
</div>
<section id="module-catalyst.utils.config">
<span id="config"></span><h2><a class="toc-backref" href="#id1">Config</a><a class="headerlink" href="#module-catalyst.utils.config" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.config.load_config">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.config.</span></span><span class="sig-name descname"><span class="pre">load_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ordered</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'utf-8'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/config.html#load_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.config.load_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads config by giving path. Supports YAML and JSON files.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./config.yml&quot;</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to config file (YAML or JSON)</p></li>
<li><p><strong>ordered</strong> – if true the config will be loaded as <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code></p></li>
<li><p><strong>data_format</strong> – <code class="docutils literal notranslate"><span class="pre">yaml</span></code>, <code class="docutils literal notranslate"><span class="pre">yml</span></code> or <code class="docutils literal notranslate"><span class="pre">json</span></code>.</p></li>
<li><p><strong>encoding</strong> – encoding to read the config</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>config</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Dict, List]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if path <code class="docutils literal notranslate"><span class="pre">path</span></code> doesn’t exists
    or file format is not YAML or JSON</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.config.save_config">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.config.</span></span><span class="sig-name descname"><span class="pre">save_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'utf-8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensure_ascii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indent</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/config.html#save_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.config.save_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves config to file. Path must be either YAML or JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>Union</em><em>[</em><em>Dict</em><em>, </em><em>List</em><em>]</em>) – config to save</p></li>
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – path to save</p></li>
<li><p><strong>data_format</strong> – <code class="docutils literal notranslate"><span class="pre">yaml</span></code>, <code class="docutils literal notranslate"><span class="pre">yml</span></code> or <code class="docutils literal notranslate"><span class="pre">json</span></code>.</p></li>
<li><p><strong>encoding</strong> – Encoding to write file. Default is <code class="docutils literal notranslate"><span class="pre">utf-8</span></code></p></li>
<li><p><strong>ensure_ascii</strong> – Used for JSON, if True non-ASCII</p></li>
<li><p><strong>strings.</strong> (<em>characters are escaped in JSON</em>) – </p></li>
<li><p><strong>indent</strong> – Used for JSON</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.distributed">
<span id="distributed"></span><h2><a class="toc-backref" href="#id2">Distributed</a><a class="headerlink" href="#module-catalyst.utils.distributed" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.all_gather">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">all_gather</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#all_gather"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.all_gather" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all_gather on arbitrary picklable data (not necessarily tensors).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>if data on different devices
then data in resulted list will be on the same devices.
Source: <a class="reference external" href="http://github.com/facebookresearch/detr/blob/master/util/misc.py#L88-L128">http://github.com/facebookresearch/detr/blob/master/util/misc.py#L88-L128</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – any picklable object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of data gathered from each process.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.ddp_reduce">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">ddp_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#ddp_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.ddp_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Syncs <code class="docutils literal notranslate"><span class="pre">tensor</span></code> over <code class="docutils literal notranslate"><span class="pre">world_size</span></code> in distributed mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> – tensor to sync across the processes.</p></li>
<li><p><strong>mode</strong> – tensor synchronization type, should be one of ‘sum’, ‘mean’ or ‘all’.</p></li>
<li><p><strong>world_size</strong> – world size</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>torch.Tensor with synchronized values.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ValueError</strong> – if mode is out of <code class="docutils literal notranslate"><span class="pre">sum</span></code>, <code class="docutils literal notranslate"><span class="pre">mean</span></code>, <code class="docutils literal notranslate"><span class="pre">all</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.get_backend">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">get_backend</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_backend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.get_backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the backend for distributed training.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.get_nn_from_ddp_module">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">get_nn_from_ddp_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.modules.module.Module</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_nn_from_ddp_module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.get_nn_from_ddp_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a real model from a torch.nn.DataParallel,
torch.nn.parallel.DistributedDataParallel, or
apex.parallel.DistributedDataParallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – A model, or DataParallel wrapper.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.get_rank">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">get_rank</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.get_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rank of the current worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">rank</span></code> if torch.distributed is initialized, otherwise <code class="docutils literal notranslate"><span class="pre">-1</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.get_world_size">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">get_world_size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_world_size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.get_world_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the world size for distributed training.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.mean_reduce">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">mean_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#mean_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.mean_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce tensor to all processes and compute mean value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tensor</strong> – tensor to reduce.</p></li>
<li><p><strong>world_size</strong> – number of processes in DDP setup.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reduced tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.distributed.sum_reduce">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.distributed.</span></span><span class="sig-name descname"><span class="pre">sum_reduce</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tensor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.Tensor</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#sum_reduce"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.distributed.sum_reduce" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce tensor to all processes and compute total (sum) value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> – tensor to reduce.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>reduced tensor</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.misc">
<span id="misc"></span><h2><a class="toc-backref" href="#id3">Misc</a><a class="headerlink" href="#module-catalyst.utils.misc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.boolean_flag">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">boolean_flag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">argparse.ArgumentParser</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">help</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shorthand</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#boolean_flag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.boolean_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a boolean flag to a parser inplace.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolean_flag</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">parser</span><span class="p">,</span> <span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;some flag&quot;</span><span class="p">,</span> <span class="n">shorthand</span><span class="o">=</span><span class="s2">&quot;f&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> – parser to add the flag to</p></li>
<li><p><strong>name</strong> – argument name
–&lt;name&gt; will enable the flag,
while –no-&lt;name&gt; will disable it</p></li>
<li><p><strong>default</strong> (<em>bool</em><em>, </em><em>optional</em>) – default value of the flag</p></li>
<li><p><strong>help</strong> – help string for the flag</p></li>
<li><p><strong>shorthand</strong> – shorthand string for the argument</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.flatten_dict">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">flatten_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictionary</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'/'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.OrderedDict</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#flatten_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.flatten_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the given dictionary flatten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> – giving dictionary</p></li>
<li><p><strong>parent_key</strong> (<em>str</em><em>, </em><em>optional</em>) – prefix nested keys with
string <code class="docutils literal notranslate"><span class="pre">parent_key</span></code></p></li>
<li><p><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – delimiter between
<code class="docutils literal notranslate"><span class="pre">parent_key</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ordered dictionary with flatten keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>collections.OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.get_attr">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.get_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for python <cite>getattr</cite> method. Useful for Callbacks preparation
and cases with multi-criterion, multi-optimizer setup.
For example, when you would like to train multi-task classification.</p>
<p>Used to get a named attribute from a <cite>IRunner</cite> by <cite>key</cite> keyword;
for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;criterion&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">criterion</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">optimizer</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;scheduler&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">scheduler</span>
</pre></div>
</div>
<p>With <cite>inner_key</cite> usage, it suppose to find a dictionary under <cite>key</cite>    and would get <cite>inner_key</cite> from this dict; for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;criterion&quot;</span><span class="p">,</span> <span class="s2">&quot;bce&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">criterion</span><span class="p">[</span><span class="s2">&quot;bce&quot;</span><span class="p">]</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">,</span> <span class="s2">&quot;adam&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">optimizer</span><span class="p">[</span><span class="s2">&quot;adam&quot;</span><span class="p">]</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;scheduler&quot;</span><span class="p">,</span> <span class="s2">&quot;adam&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">scheduler</span><span class="p">[</span><span class="s2">&quot;adam&quot;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object of interest</p></li>
<li><p><strong>key</strong> – name for attribute of interest,
like <cite>criterion</cite>, <cite>optimizer</cite>, <cite>scheduler</cite></p></li>
<li><p><strong>inner_key</strong> – name of inner dictionary key</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>inner attribute</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.get_by_keys">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_by_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dict_</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">keys</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">catalyst.utils.misc.T</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">catalyst.utils.misc.T</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_by_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.get_by_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Docs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.get_hash">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.get_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates unique hash from object following way:
- Represent obj as sting recursively
- Hash this string with sha256 hash function
- encode hash with url-safe base64 encoding</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – object to hash</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>base64-encoded string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.get_short_hash">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_short_hash</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obj</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_short_hash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.get_short_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates unique short hash from object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – object to hash</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>short base64-encoded string (6 chars)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.get_utcnow_time">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">get_utcnow_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_utcnow_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.get_utcnow_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with current utc time in chosen format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>format</strong> – format string. if None “%y%m%d.%H%M%S” will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>formatted utc time string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.make_tuple">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">make_tuple</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tuple_like</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#make_tuple"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.make_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a tuple if given <code class="docutils literal notranslate"><span class="pre">tuple_like</span></code> value isn’t list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tuple_like</strong> – tuple like object - list or tuple</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple or list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.maybe_recursive_call">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">maybe_recursive_call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_or_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recursive_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#maybe_recursive_call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.maybe_recursive_call" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">method</span></code> recursively for the <code class="docutils literal notranslate"><span class="pre">object_or_dict</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_or_dict</strong> – some object or a dictionary of objects</p></li>
<li><p><strong>method</strong> – method name to call</p></li>
<li><p><strong>recursive_args</strong> – list of arguments to pass to the <code class="docutils literal notranslate"><span class="pre">method</span></code></p></li>
<li><p><strong>recursive_kwargs</strong> – list of key-arguments to pass to the <code class="docutils literal notranslate"><span class="pre">method</span></code></p></li>
<li><p><strong>**kwargs</strong> – Arbitrary keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result of <cite>method</cite> call</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.merge_dicts">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">merge_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">dicts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#merge_dicts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.merge_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive dict merge.
Instead of updating only top-level keys,
<code class="docutils literal notranslate"><span class="pre">merge_dicts</span></code> recurses down into dicts nested
to an arbitrary depth, updating keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*dicts</strong> – several dictionaries to merge</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>deep-merged dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.pairwise">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">pairwise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">catalyst.utils.misc.T</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">catalyst.utils.misc.T</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">catalyst.utils.misc.T</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#pairwise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.pairwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate sequences by pairs.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pairwise</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">(1, 2)</span>
<span class="go">(2, 5)</span>
<span class="go">(5, -3)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterable</strong> – Any iterable sequence</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pairwise iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.misc.set_global_seed">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.misc.</span></span><span class="sig-name descname"><span class="pre">set_global_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#set_global_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.misc.set_global_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets random seed into Numpy and Random, PyTorch and TensorFlow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – random seed</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.onnx">
<span id="onnx"></span><h2><a class="toc-backref" href="#id4">Onnx</a><a class="headerlink" href="#module-catalyst.utils.onnx" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.onnx.onnx_export">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.onnx.</span></span><span class="sig-name descname"><span class="pre">onnx_export</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.Tensor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'forward'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opset_version</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_constant_folding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">onnx</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/onnx.html#onnx_export"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.onnx.onnx_export" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts model to onnx runtime.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model</p></li>
<li><p><strong>batch</strong> – inputs</p></li>
<li><p><strong>file</strong> – file to save. Defaults to “model.onnx”.</p></li>
<li><p><strong>method_name</strong> – Forward pass method to be converted. Defaults to “forward”.</p></li>
<li><p><strong>input_names</strong> – name of inputs in graph. Defaults to None.</p></li>
<li><p><strong>output_names</strong> – name of outputs in graph. Defaults to None.</p></li>
<li><p><strong>dynamic_axes</strong> – axes
with dynamic shapes. Defaults to None.</p></li>
<li><p><strong>opset_version</strong> – Defaults to 9.</p></li>
<li><p><strong>do_constant_folding</strong> – If True, the constant-folding optimization
is applied to the model during export. Defaults to False.</p></li>
<li><p><strong>return_model</strong> – If True then returns onnxruntime model (onnx required).
Defaults to False.</p></li>
<li><p><strong>verbose</strong> – if specified, we will print out a debug
description of the trace being exported.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">catalyst.utils</span> <span class="kn">import</span> <span class="n">convert_to_onnx</span>

<span class="k">class</span> <span class="nc">LinModel</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp_1</span><span class="p">,</span> <span class="n">inp_2</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span><span class="p">(</span><span class="n">inp_1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span><span class="p">(</span><span class="n">inp_2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">first_only</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp_1</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span><span class="p">(</span><span class="n">inp_1</span><span class="p">)</span>

<span class="n">lin_model</span> <span class="o">=</span> <span class="n">LinModel</span><span class="p">()</span>
<span class="n">convert_to_onnx</span><span class="p">(</span>
    <span class="n">model</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)),</span>
    <span class="n">file</span><span class="o">=</span><span class="s2">&quot;model.onnx&quot;</span><span class="p">,</span>
    <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;first_only&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>ImportError</strong> – when <code class="docutils literal notranslate"><span class="pre">return_model</span></code> is True, but onnx is not installed.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>onnx model if return_model set to True.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[None, “onnx”]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.onnx.quantize_onnx_model">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.onnx.</span></span><span class="sig-name descname"><span class="pre">quantize_onnx_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">onnx_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantized_model_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'qint8'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/onnx.html#quantize_onnx_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.onnx.quantize_onnx_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes model converted to onnx runtime and applies pruning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>onnx_model_path</strong> – path to onnx model.</p></li>
<li><p><strong>quantized_model_path</strong> – path to quantized model.</p></li>
<li><p><strong>qtype</strong> – Type of weights in quantized model.
Can be <cite>quint8</cite> or <cite>qint8</cite>. Defaults to “qint8”.</p></li>
<li><p><strong>verbose</strong> – If set to True prints model size before
and after quantization. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If qtype is not understood.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.pruning">
<span id="pruning"></span><h2><a class="toc-backref" href="#id5">Pruning</a><a class="headerlink" href="#module-catalyst.utils.pruning" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.pruning.get_pruning_fn">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.pruning.</span></span><span class="sig-name descname"><span class="pre">get_pruning_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pruning_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/pruning.html#get_pruning_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.pruning.get_pruning_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>[summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pruning_fn</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Callable</em><em>]</em>) – function from torch.nn.utils.prune module
or your based on BasePruningMethod. Can be string e.g.
<cite>“l1_unstructured”</cite>. See pytorch docs for more details.</p></li>
<li><p><strong>dim</strong> (<em>int</em><em>, </em><em>optional</em>) – if you are using structured pruning method you need
to specify dimension. Defaults to None.</p></li>
<li><p><strong>l_norm</strong> (<em>int</em><em>, </em><em>optional</em>) – if you are using
ln_structured you need to specify l_norm. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <code class="docutils literal notranslate"><span class="pre">dim</span></code> or <code class="docutils literal notranslate"><span class="pre">l_norm</span></code> is not defined when it’s required.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>pruning_fn</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.pruning.prune_model">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.pruning.</span></span><span class="sig-name descname"><span class="pre">prune_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pruning_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amount</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_to_prune</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_prune</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l_norm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/pruning.html#prune_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.pruning.prune_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune model function can be used for pruning certain
tensors in model layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to be pruned.</p></li>
<li><p><strong>pruning_fn</strong> – Pruning function with API same as in torch.nn.utils.pruning.
pruning_fn(module, name, amount).</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings.
Determines which tensor in modules will be pruned.</p></li>
<li><p><strong>amount</strong> – quantity of parameters to prune.
If float, should be between 0.0 and 1.0 and
represent the fraction of parameters to prune.
If int, it represents the absolute number
of parameters to prune.</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names to be pruned.
If None provided then will try to prune every module in model.</p></li>
<li><p><strong>dim</strong> (<em>int</em><em>, </em><em>optional</em>) – if you are using structured pruning method you need
to specify dimension. Defaults to None.</p></li>
<li><p><strong>l_norm</strong> (<em>int</em><em>, </em><em>optional</em>) – if you are using
ln_structured you need to specify l_norm. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pruned_model</span> <span class="o">=</span> <span class="n">prune_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">pruning_fn</span><span class="o">=</span><span class="s2">&quot;l1_unstructured&quot;</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AttributeError</strong> – If layers_to_prune is not None, but there is
    no layers with specified name. OR</p></li>
<li><p><strong>ValueError</strong> – if no layers have specified keys.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.pruning.remove_reparametrization">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.pruning.</span></span><span class="sig-name descname"><span class="pre">remove_reparametrization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys_to_prune</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers_to_prune</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/pruning.html#remove_reparametrization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.pruning.remove_reparametrization" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes pre-hooks and pruning masks from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to remove reparametrization.</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings. Determines
which tensor in modules have already been pruned.</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names
have already been pruned.
If None provided then will try to prune every module in
model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.quantization">
<span id="quantization"></span><h2><a class="toc-backref" href="#id6">Quantization</a><a class="headerlink" href="#module-catalyst.utils.quantization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.quantization.quantize_model">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.quantization.</span></span><span class="sig-name descname"><span class="pre">quantize_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qconfig_spec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.dtype</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'qint8'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.nn.modules.module.Module</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/quantization.html#quantize_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.quantization.quantize_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to quantize model weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to be quantized</p></li>
<li><p><strong>qconfig_spec</strong> (<em>Dict</em><em>, </em><em>optional</em>) – quantization config in PyTorch format.
Defaults to None.</p></li>
<li><p><strong>dtype</strong> – Type of weights after quantization.
Defaults to “qint8”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>quantized model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Model</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.torch">
<span id="torch"></span><h2><a class="toc-backref" href="#id7">Torch</a><a class="headerlink" href="#module-catalyst.utils.torch" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.any2device">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">any2device</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.device</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.nn.modules.module.Module</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#any2device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.any2device" title="Permalink to this definition">¶</a></dt>
<dd><p>Move tensor, list of tensors, list of list of tensors,
dict of tensors, tuple of tensors to target device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Object to be moved</p></li>
<li><p><strong>device</strong> – target device ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Same structure as value, but all tensors and np.arrays moved to device</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_available_engine">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_available_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cpu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fp16</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="core.html#catalyst.core.engine.Engine" title="catalyst.core.engine.Engine"><span class="pre">Engine</span></a></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_available_engine"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_available_engine" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns available engine based on given arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cpu</strong> (<em>bool</em>) – option to use cpu for training. Default is <cite>False</cite>.</p></li>
<li><p><strong>ddp</strong> (<em>bool</em>) – option to use DDP for training. Default is <cite>False</cite>.</p></li>
<li><p><strong>fp16</strong> (<em>bool</em>) – option to use APEX for training. Default is <cite>False</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Engine which match requirements.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_available_gpus">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_available_gpus</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_available_gpus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_available_gpus" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of available GPU ids.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0,2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[0, 2]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0,-1,1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>available GPU ids</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>iterable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_device">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_device</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.device</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_device"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple returning the best available device (TPU &gt; GPU &gt; CPU).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_optimizer_momentum">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_optimizer_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.optim.optimizer.Optimizer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimizer_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimizer_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get momentum of current optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – PyTorch optimizer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>momentum at first param group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_optimizer_momentum_list">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_optimizer_momentum_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.optim.optimizer.Optimizer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimizer_momentum_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimizer_momentum_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of optimizer momentums (for each param group)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – PyTorch optimizer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>momentum for each param group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>momentum_list (List[Union[float, None]])</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.get_requires_grad">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">get_requires_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_requires_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.get_requires_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> value for all model parameters.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requires_grad</span> <span class="o">=</span> <span class="n">get_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>requires_grad</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.mixup_batch">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">mixup_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'replace'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#mixup_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.mixup_batch" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong> – batch to which you want to apply augmentation</p></li>
<li><p><strong>alpha</strong> – beta distribution a=b parameters.
Must be &gt;=0. The closer alpha to zero the less effect of the mixup.</p></li>
<li><p><strong>mode</strong> – algorithm used for muxup: <code class="docutils literal notranslate"><span class="pre">&quot;replace&quot;</span></code> | <code class="docutils literal notranslate"><span class="pre">&quot;add&quot;</span></code>. If “replace”
then replaces the batch with a mixed one, while the batch size is not changed
If “add”, concatenates mixed examples to the current ones,
the batch size increases by 2 times.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>augmented batch</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.prepare_cudnn">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">prepare_cudnn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">benchmark</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#prepare_cudnn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.prepare_cudnn" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares CuDNN benchmark and sets CuDNN
to be deterministic/non-deterministic mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deterministic</strong> – deterministic mode if running in CuDNN backend.</p></li>
<li><p><strong>benchmark</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> use CuDNN heuristics to figure out
which algorithm will be most performant
for your model architecture and input.
Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> may slow down your training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.set_optimizer_momentum">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">set_optimizer_momentum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.optim.optimizer.Optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#set_optimizer_momentum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.set_optimizer_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Set momentum of <code class="docutils literal notranslate"><span class="pre">index</span></code> ‘th param group of optimizer to <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – PyTorch optimizer</p></li>
<li><p><strong>value</strong> – new value of momentum</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – integer index of optimizer’s param groups,
default is 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.set_requires_grad">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">set_requires_grad</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">requires_grad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#set_requires_grad"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.set_requires_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> value for all model parameters.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">})</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model</p></li>
<li><p><strong>requires_grad</strong> – value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.torch.soft_update">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.torch.</span></span><span class="sig-name descname"><span class="pre">soft_update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#soft_update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.torch.soft_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the <cite>target</cite> data with the <cite>source</cite> one
smoothing by <code class="docutils literal notranslate"><span class="pre">tau</span></code> (inplace operation).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> – nn.Module to update</p></li>
<li><p><strong>source</strong> – nn.Module for updating</p></li>
<li><p><strong>tau</strong> – smoothing parametr</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.utils.tracing">
<span id="tracing"></span><h2><a class="toc-backref" href="#id8">Tracing</a><a class="headerlink" href="#module-catalyst.utils.tracing" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.utils.tracing.trace_model">
<span class="sig-prename descclassname"><span class="pre">catalyst.utils.tracing.</span></span><span class="sig-name descname"><span class="pre">trace_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">torch.nn.modules.module.Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">torch.Tensor</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'forward'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">torch.jit._script.ScriptModule</span></span></span><a class="reference internal" href="../_modules/catalyst/utils/tracing.html#trace_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.utils.tracing.trace_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Traces model using runner and batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to trace</p></li>
<li><p><strong>batch</strong> – Batch to trace the model</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be
used as entrypoint during tracing</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">from</span> <span class="nn">catalyst.utils</span> <span class="kn">import</span> <span class="n">trace_model</span>

<span class="k">class</span> <span class="nc">LinModel</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp_1</span><span class="p">,</span> <span class="n">inp_2</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span><span class="p">(</span><span class="n">inp_1</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin2</span><span class="p">(</span><span class="n">inp_2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">first_only</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inp_1</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lin1</span><span class="p">(</span><span class="n">inp_1</span><span class="p">)</span>

<span class="n">lin_model</span> <span class="o">=</span> <span class="n">LinModel</span><span class="p">()</span>
<span class="n">traced_model</span> <span class="o">=</span> <span class="n">trace_model</span><span class="p">(</span>
    <span class="n">lin_model</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">method_name</span><span class="o">=</span><span class="s2">&quot;first_only&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Traced model</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>jit.ScriptModule</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.contrib.utils.image">
<span id="image-contrib"></span><h2><a class="toc-backref" href="#id9">Image (contrib)</a><a class="headerlink" href="#module-catalyst.contrib.utils.image" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.image.has_image_extension">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.image.</span></span><span class="sig-name descname"><span class="pre">has_image_extension</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/image.html#has_image_extension"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.image.has_image_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that file has image extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uri</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – the resource to load the file from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if file has image extension, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.image.imread">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.image.</span></span><span class="sig-name descname"><span class="pre">imread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grayscale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rootpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/image.html#imread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.image.imread" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an image from the specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uri</strong> (<em>str</em><em>, </em><em>pathlib.Path</em><em>, </em><em>bytes</em><em>, </em><em>file</em>) – the resource to load the image
from, e.g. a filename, <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>, http address or file object,
see <code class="docutils literal notranslate"><span class="pre">imageio.imread</span></code> docs for more info</p></li>
<li><p><strong>grayscale</strong> – if True, make all images grayscale</p></li>
<li><p><strong>expand_dims</strong> – if True, append channel axis to grayscale images
rootpath (Union[str, pathlib.Path]): path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>rootpath</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>**kwargs</strong> – extra params for image read</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.image.imsave">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.image.</span></span><span class="sig-name descname"><span class="pre">imsave</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/image.html#imsave"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.image.imsave" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">imwrite(uri,</span> <span class="pre">im,</span> <span class="pre">format=None,</span> <span class="pre">**kwargs)</span></code></p>
<p>Write an image to the specified file.
Alias for <code class="docutils literal notranslate"><span class="pre">imageio.imsave</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – parameters for <code class="docutils literal notranslate"><span class="pre">imageio.imsave</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image save result</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.image.imwrite">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.image.</span></span><span class="sig-name descname"><span class="pre">imwrite</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/image.html#imwrite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.image.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">imwrite(uri,</span> <span class="pre">im,</span> <span class="pre">format=None,</span> <span class="pre">**kwargs)</span></code></p>
<p>Write an image to the specified file.
Alias for <code class="docutils literal notranslate"><span class="pre">imageio.imwrite</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – parameters for <code class="docutils literal notranslate"><span class="pre">imageio.imwrite</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image save result</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.image.mimread">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.image.</span></span><span class="sig-name descname"><span class="pre">mimread</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clip_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expand_dims</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rootpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">numpy.ndarray</span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/image.html#mimread"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.image.mimread" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads multiple images from the specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uri</strong> (<em>str</em><em>, </em><em>pathlib.Path</em><em>, </em><em>bytes</em><em>, </em><em>file</em>) – the resource to load the image
from, e.g. a filename, <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>, http address or file object,
see <code class="docutils literal notranslate"><span class="pre">imageio.mimread</span></code> docs for more info</p></li>
<li><p><strong>clip_range</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – lower and upper interval edges,
image values outside the interval are clipped to the interval edges</p></li>
<li><p><strong>expand_dims</strong> – if True, append channel axis to grayscale images
rootpath (Union[str, pathlib.Path]): path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>rootpath</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>**kwargs</strong> – extra params for image read</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.contrib.utils.report">
<span id="report-contrib"></span><h2><a class="toc-backref" href="#id10">Report (contrib)</a><a class="headerlink" href="#module-catalyst.contrib.utils.report" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.report.get_classification_report">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.report.</span></span><span class="sig-name descname"><span class="pre">get_classification_report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/report.html#get_classification_report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.report.get_classification_report" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates pandas-based per-class and aggregated classification metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>np.ndarray</em>) – ground truth labels</p></li>
<li><p><strong>y_pred</strong> (<em>np.ndarray</em>) – predicted model labels</p></li>
<li><p><strong>y_scores</strong> (<em>np.ndarray</em>) – predicted model scores. Defaults to None.</p></li>
<li><p><strong>beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Beta parameter for custom Fbeta score computation.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas dataframe with main classification metrics.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span><span class="p">,</span> <span class="n">linear_model</span><span class="p">,</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">catalyst</span> <span class="kn">import</span> <span class="n">utils</span>

<span class="n">digits</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_digits</span><span class="p">()</span>

<span class="c1"># flatten the images</span>
<span class="n">n_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">digits</span><span class="o">.</span><span class="n">images</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_samples</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="c1"># Create a classifier</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LogisticRegression</span><span class="p">(</span><span class="n">multi_class</span><span class="o">=</span><span class="s2">&quot;ovr&quot;</span><span class="p">)</span>

<span class="c1"># Split data into 50% train and 50% test subsets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">digits</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Learn the digits on the train subset</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict the value of the digit on the test subset</span>
<span class="n">y_scores</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">utils</span><span class="o">.</span><span class="n">get_classification_report</span><span class="p">(</span>
    <span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span>
    <span class="n">y_pred</span><span class="o">=</span><span class="n">y_pred</span><span class="p">,</span>
    <span class="n">y_scores</span><span class="o">=</span><span class="n">y_scores</span><span class="p">,</span>
    <span class="n">beta</span><span class="o">=</span><span class="mf">0.5</span>
<span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-catalyst.contrib.utils.thresholds">
<span id="thresholds-contrib"></span><h2><a class="toc-backref" href="#id11">Thresholds (contrib)</a><a class="headerlink" href="#module-catalyst.contrib.utils.thresholds" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_baseline_thresholds">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_baseline_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_baseline_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_baseline_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns baseline thresholds for multiclass/multilabel classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>labels</strong> – ground truth labels,
numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_best_multiclass_thresholds">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_best_multiclass_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_best_multiclass_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_best_multiclass_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for multiclass classification task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_best_multilabel_thresholds">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_best_multilabel_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_best_multilabel_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_best_multilabel_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for multilabel classification task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_binary_threshold">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_binary_threshold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_binary_threshold"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_binary_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best threshold for binary classification task
based on cross-validation estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, ]</p></li>
<li><p><strong>labels</strong> – ground truth labels, numpy array with shape [num_examples, ]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
<li><p><strong>num_thresholds</strong> – number of thresholds ot try for each class</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_binary_threshold_cv">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_binary_threshold_cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_binary_threshold_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_binary_threshold_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best threshold
for binary classification task based on cross-validation estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, ]</p></li>
<li><p><strong>labels</strong> – ground truth labels, numpy array with shape [num_examples, ]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
<li><p><strong>num_splits</strong> – number of splits to use for cross-validation</p></li>
<li><p><strong>num_repeats</strong> – number of repeats to use for cross-validation</p></li>
<li><p><strong>random_state</strong> – random state to use for cross-validation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and threshold</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_multiclass_thresholds">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_multiclass_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_multiclass_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_multiclass_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for multiclass classification task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>labels</strong> – ground truth labels, numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_multiclass_thresholds_greedy">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_multiclass_thresholds_greedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_multiclass_thresholds_greedy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_multiclass_thresholds_greedy" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds
for multiclass classification task with brute-force algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
<li><p><strong>num_iterations</strong> – number of iteration for brute-force algorithm</p></li>
<li><p><strong>num_thresholds</strong> – number of thresholds ot try for each class</p></li>
<li><p><strong>thresholds</strong> – baseline thresholds, which we want to optimize</p></li>
<li><p><strong>patience</strong> – maximum number of iteration before early stop exit</p></li>
<li><p><strong>atol</strong> – minimum required improvement per iteration for early stop exit</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_multilabel_thresholds">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_multilabel_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_multilabel_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_multilabel_thresholds" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for multilabel classification task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>labels</strong> – ground truth labels, numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_multilabel_thresholds_cv">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_multilabel_thresholds_cv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_repeats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_multilabel_thresholds_cv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_multilabel_thresholds_cv" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for multilabel classification task
based on cross-validation estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model,
numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>labels</strong> – ground truth labels, numpy array with shape [num_examples, num_classes]</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
<li><p><strong>num_splits</strong> – number of splits to use for cross-validation</p></li>
<li><p><strong>num_repeats</strong> – number of repeats to use for cross-validation</p></li>
<li><p><strong>random_state</strong> – random state to use for cross-validation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_multilabel_thresholds_greedy">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_multilabel_thresholds_greedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">objective</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_multilabel_thresholds_greedy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_multilabel_thresholds_greedy" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds
for multilabel classification task with brute-force algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>objective</strong> – callable function, metric which we want to maximize</p></li>
<li><p><strong>num_iterations</strong> – number of iteration for brute-force algorithm</p></li>
<li><p><strong>num_thresholds</strong> – number of thresholds ot try for each class</p></li>
<li><p><strong>thresholds</strong> – baseline thresholds, which we want to optimize</p></li>
<li><p><strong>patience</strong> – maximum number of iteration before early stop exit</p></li>
<li><p><strong>atol</strong> – minimum required improvement per iteration for early stop exit</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.thresholds.get_thresholds_greedy">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.thresholds.</span></span><span class="sig-name descname"><span class="pre">get_thresholds_greedy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/catalyst/contrib/utils/thresholds.html#get_thresholds_greedy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.thresholds.get_thresholds_greedy" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds best thresholds for classification task with brute-force algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> – estimated per-class scores/probabilities predicted by the model</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>score_fn</strong> – callable function, based on (scores, labels, thresholds)</p></li>
<li><p><strong>num_iterations</strong> – number of iteration for brute-force algorithm</p></li>
<li><p><strong>num_thresholds</strong> – number of thresholds ot try for each class</p></li>
<li><p><strong>thresholds</strong> – baseline thresholds, which we want to optimize</p></li>
<li><p><strong>patience</strong> – maximum number of iteration before early stop exit</p></li>
<li><p><strong>atol</strong> – minimum required improvement per iteration for early stop exit</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with best found objective score and per-class thresholds</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-catalyst.contrib.utils.visualization">
<span id="visualization-contrib"></span><h2><a class="toc-backref" href="#id12">Visualization (contrib)</a><a class="headerlink" href="#module-catalyst.contrib.utils.visualization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.visualization.plot_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.visualization.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'confusion</span> <span class="pre">matrix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fontsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colormap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Blues'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/visualization.html#plot_confusion_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.visualization.plot_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the confusion matrix and return matplotlib”s figure with it.
Normalization can be applied by setting <cite>normalize=True</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> – numpy confusion matrix</p></li>
<li><p><strong>class_names</strong> – class names</p></li>
<li><p><strong>normalize</strong> – boolean flag to normalize confusion matrix</p></li>
<li><p><strong>title</strong> – title</p></li>
<li><p><strong>fname</strong> – filename to save confusion matrix</p></li>
<li><p><strong>show</strong> – boolean flag for preview</p></li>
<li><p><strong>figsize</strong> – matplotlib figure size</p></li>
<li><p><strong>fontsize</strong> – matplotlib font size</p></li>
<li><p><strong>colormap</strong> – matplotlib color map</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib figure</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="catalyst.contrib.utils.visualization.render_figure_to_array">
<span class="sig-prename descclassname"><span class="pre">catalyst.contrib.utils.visualization.</span></span><span class="sig-name descname"><span class="pre">render_figure_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">figure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/visualization.html#render_figure_to_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#catalyst.contrib.utils.visualization.render_figure_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Renders matplotlib”s figure to tensor.</p>
</dd></dl>

</section>
</section>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="runners.html" class="btn btn-neutral" title="Runners" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Scitator.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="catalyst-content-right" id="catalyst-content-right">
          <div class="catalyst-right-menu" id="catalyst-right-menu">
            <div class="catalyst-side-scroll" id="catalyst-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Utils</a><ul>
<li><a class="reference internal" href="#module-catalyst.utils.config">Config</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.distributed">Distributed</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.misc">Misc</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.onnx">Onnx</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.pruning">Pruning</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.quantization">Quantization</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.torch">Torch</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.tracing">Tracing</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.image">Image (contrib)</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.report">Report (contrib)</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.thresholds">Thresholds (contrib)</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.visualization">Visualization (contrib)</a></li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
         <script src="../_static/jquery.js"></script>
         <script src="../_static/underscore.js"></script>
         <script src="../_static/doctools.js"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://catalyst-team.com/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Ecosystem</a></li>
            <li><a class="nav-dropdown-item" href="https://alchemy.host">Alchemy</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">Catalyst</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">Reaction</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Projects</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">Catalyst.Neuro</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">Classification</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">Detection</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">Segmentation</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">Catalyst.GAN</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://catalyst-team.com/">Support</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
            <li><a href="https://www.patreon.com/catalyst_team" target="_blank">Patreon</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <div class="footer-social-icons">
            <a href="https://t.me/catalyst_team" target="_blank" class="telegram"></a>
            <a href="https://twitter.com/catalyst_core" target="_blank" class="twitter"></a>
            <a href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw" target="_blank" class="ods"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="">Get Started</a>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/catalyst">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      catalystAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.catalyst-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>